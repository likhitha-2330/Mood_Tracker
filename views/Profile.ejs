<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Profile</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins&family=Handlee&family=Kalam:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/Profile.css">
</head>
<body>

  <div class="profile-card">
    <div class="avatar">
      <img src="../images/avatar.jpg" alt="Avatar">
    </div>
    <h1 class="profile-name"><%= Name %></h1>
    <h3>Age: <%= Age %></h3>
    <h3>Email: <%= Email %></h3>
    <div class="streak">üåª Your Current Streak: <%= locals.Days || 0 %> Days</div>

    <div class="container1">
      <div class="text2">‚öôÔ∏è Settings</div>

      <button class="profile-btn" id="edit">Edit Profile</button>
      <button class="profile-btn" id="pass">Change Password</button>

      <form action="/export" method="get">
        <button class="profile-btn">Export My Data</button>
      </form>

      <form action="/delete" method="get">
        <button class="profile-btn danger">Delete Account</button>
      </form>

      <p id="errorMsg" <%= locals.msg ? "" : "hidden" %> >
        <%= locals.msg %>
      </p>
    </div>
  </div>

  <div class="modal" id="editModal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeModal('editModal')">&times;</span>
      <h2>Edit Profile</h2>
      <form action="/edit1" method="post">
        <input type="text" name="UserName" placeholder="New UserName">
        <input type="number" name="Age" placeholder="Age">
        <input type="email" name="Email" placeholder="Email">
        <input type="password" name="Password" placeholder="Current Password (To Change Details)" required>
        <button class="profile-btn">Submit</button>
      </form>
    </div>
  </div>

  <div class="modal" id="passModal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeModal('passModal')">&times;</span>
      <h2>Change Password</h2>
      <form action="/pass" method="post">
        <input type="password" name="Current" placeholder="Current Password" required>
        <input type="password" name="New" placeholder="New Password" required>
        <button class="profile-btn">Submit</button>
      </form>
    </div>
  </div>

  <nav class="navbar">
    <a href="/home" class="nav-link">Home</a>
    <a href="/Reports" class="nav-link">Reports</a>
    <a href="/profile" class="nav-link active">Profile</a>
  </nav>

  <script>
    const editBtn = document.getElementById("edit");
    const passBtn = document.getElementById("pass");
    const editModal = document.getElementById("editModal");
    const passModal = document.getElementById("passModal");

    editBtn.addEventListener("click", () => editModal.style.display = "flex");
    passBtn.addEventListener("click", () => passModal.style.display = "flex");

    window.addEventListener("click", (e) => {
      if (e.target === editModal) editModal.style.display = "none";
      if (e.target === passModal) passModal.style.display = "none";
    });

    function closeModal(id) {
      document.getElementById(id).style.display = "none";
    }

    window.addEventListener("keydown", (e) => {
      if(e.key === "Escape") {
        editModal.style.display = "none";
        passModal.style.display = "none";
      }
    });
  </script>

</body>
</html>
